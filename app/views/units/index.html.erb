<h2>Units</h2>

<% if @units.empty? %>
  <p>There are no units configured for this building.</p>
<% else  %>

<%= render partial: 'summary' -%>

<table>
  <thead>
    <tr>
      <th colspan="1">Unit</th>
      <th colspan="2">Tenant</th>
    </tr>
  </thead>

  <tbody>
    <% @units.each do |unit| %>
      <tr>
	<td>
           <strong> <%= unit.name %> </strong>
           <small>
	   <%= link_to 'details', building_unit_path(@building,unit) %>
            <%= link_to 'edit', edit_building_unit_path(@building, unit) %>
	    <% if unit.tenancy.blank? %>
	    <%= link_to 'delete unit', building_unit_path(@building,unit), 
		  method: :delete, 
		  data: { confirm: 'Are you sure?' } %>
	  <% end %>
           </small>
	</td>
	<td>
	  <small>
          <% if unit.tenancy.present? %>
           <%= unit.tenancy.user.email -%> 
	   <%= link_to 'end tenancy', 
	          unit_tenancy_path(unit, unit.tenancy), 
		  method: :delete, 
		  data: { confirm: 'Are you sure?' }
	   %>
	  <%= link_to 'send message', new_building_user_message_path(@building, unit.tenancy.user)  -%>
          <% else %>
	     <%= link_to 'assign to tenant', new_unit_tenancy_path(unit) %>
	  <% end %>
	   </small>
	</td>
      </tr>
    <% end %>
  </tbody>
</table>

<p> <%= paginate(@units) %> </p>

<% end %>

<h2>Enter a new unit</h2>

<%= render partial: 'form' -%>
